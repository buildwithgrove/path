# This file allows optional configuration of the PATH service.
# It is used to customize the PATH service for local development in two main ways:

# See the PATH Helm Chart `values.yaml` file for the full set of available customizations.
# https://github.com/buildwithgrove/helm-charts/blob/main/charts/path/values.yaml
# https://github.com/buildwithgrove/helm-charts/blob/main/charts/guard/values.yaml#L202

# ðŸš¨ IMPORTANT: To use this file ðŸš¨
# 1. Run `make configs_copy_values_yaml` to create the .gitignored `.values.yaml` file if not already present.
# 2. Make any changes to the `local/path/.values.yaml` file, then save. Tilt will
#    automatically pick up the changes and restart PATH & GUARD with the updated values.

###########################################################################
# -------------------- GUARD Specific Configurations -------------------- #
###########################################################################
guard:
  # The services section allows configuring the HTTPRoutes that the PATH service will
  # use to route requests to the correct service.
  #
  # 1. Each service must have a unique service ID.
  # 2. Each service can have a list of aliases that can be used to route requests to the service.
  services:
    - serviceId: anvil
    - serviceId: pocket
    - serviceId: eth
      aliases:
        - ethereum
    - serviceId: poly
      aliases:
        - polygon
    - serviceId: xrplevm

  # The auth section allows configuring the API key authentication for the PATH service.
  auth:
    apiKey:
      # To disable API key authentication, set `enabled` to `false`.
      enabled: true
      # The `apiKeys` section allows configuring the allowed set of API keys for the PATH service.
      apiKeys:
        - test_api_key
        # - api_key_123
        # - api_key_456
        # etc..

  ###########################################################################
  # ------------------------- GUARD Helm Configurations --------------------- #
  ###########################################################################
  # TODO_TECHDEBT: This is a temporary fix to use the pre-release version of the ratelimit image.
  # Can remove 'global' and all child keys once the release version of ratelimit is available
  # PR reference: https://github.com/envoyproxy/ratelimit/pull/941#issuecomment-3186314121
  # Discord discussion: https://discord.com/channels/824324475256438814/1404887238562545786/1405564826717130893
  # Dockerhub image: https://hub.docker.com/layers/envoyproxy/ratelimit/38f01982/images/sha256-3bdd0399d31e72332823ca618b4f9ea7cfa9ad8ed27b793fa5d7ef7882ea2057
  gateway-helm:
    global:
      images:
        ratelimit:
          image: "envoyproxy/ratelimit:38f01982"
          pullPolicy: Always
    config:
      envoyGateway:
        extensionApis: null
        extensionManager: null
